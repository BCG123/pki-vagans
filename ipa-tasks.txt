
playbook: ansible/ipa-playbook.yml

  play #1 (safe-guard against race condition):	TAGS: []
    wait for the node to be ready	TAGS: [bootstrap]

  play #2 (install IPA base system):	TAGS: []
    Check default route	TAGS: [bootstrap]
    Create some default route	TAGS: [bootstrap]
    Check nameserver in /etc/resolv.conf	TAGS: [bootstrap]
    Kick DHCP in case /etc/resolv.conf is missing nameserver	TAGS: [bootstrap]
    Check for dnf command	TAGS: [bootstrap, package-install]
    Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
    Refresh dnf cache	TAGS: [bootstrap, network, package-install]
    Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
    Gather facts	TAGS: [bootstrap]
    Dump ssh-config	TAGS: [bootstrap]
    Dummy (for ansible.skip_tags)	TAGS: [dummy]
    DNF or YUM?	TAGS: [common]
    Default facts (enable_packages, enable_network)	TAGS: [common]
    Override enable_packages=true	TAGS: [common, package-install]
    Override enable_network=true	TAGS: [common, network]
    fix /etc/hosts	TAGS: [common]
    Set FQDN hostname	TAGS: [common]
    Get timedatectl information	TAGS: [common]
    Set timezone to UTC	TAGS: [common]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto select fastest DNF mirror	TAGS: [common, package-install]
    Enable yum for Fedora	TAGS: [common, network, package-install]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto-select fastest yum mirror	TAGS: [common, network, package-install]
    Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
    Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
    Create directory for custom RPMS	TAGS: [common, custom-rpms]
    Synchronize RPMs	TAGS: [common, custom-rpms]
    find custom RPMs	TAGS: [common, custom-rpms]
    install custom RPMs	TAGS: [common, custom-rpms]
    install selinux tools	TAGS: [common, network, package-install]
    disable selinux for 389-DS installation	TAGS: [common, lxc]
    install firewalld	TAGS: [firewall, network, package-install, pki]
    check for firewalld	TAGS: [common, firewall]
    Enable and start firewalld	TAGS: [common, firewall]
    Install rng tools	TAGS: [common, network, package-install]
    Start the rngd service	TAGS: [common]
    tty-less sudo	TAGS: [common]
    make a copy of original resolv.conf	TAGS: [ipa]
    Get default DNS	TAGS: [ipa]
    Get reverse zone	TAGS: [ipa]
    install FreeIPA client package (Fedora)	TAGS: [ipa, network, package-install]
    install FreeIPA client package (RHEL / CentOS)	TAGS: [ipa, network, package-install]
    get IPA version	TAGS: [ipa]
    Check for /etc/ipa/ca.crt	TAGS: [ipa]
    Check for /etc/ipa/default.conf	TAGS: [ipa]
    Set ipa_installed fact	TAGS: [ipa]

  play #3 (install IPA server system):	TAGS: []
    install FreeIPA server package (Fedora)	TAGS: [ipaserver, network, package-install]
    install FreeIPA server package (RHEL / CentOS)	TAGS: [ipaserver, network, package-install]
    Open Firewall for services	TAGS: [firewall, ipaserver]
    Open Firewall for ports	TAGS: [firewall, ipaserver]

  play #4 (install FreeIPA server master):	TAGS: []
    Install FreeIPA master (5-7 minutes)	TAGS: [ipa-install, ipaserver-master]
    Install KRA on FreeIPA master (2-3 minutes)	TAGS: [ipa-install, ipaserver-master]
    Make sure named-pkcs11 DNS is restarted	TAGS: [ipa-install, ipaserver-master]
    wait for services to come up	TAGS: [ipa-install, ipaserver-master]
    Set sensible defaults	TAGS: [ipa-install, ipaserver-master]
    Set home directory to /export/home	TAGS: [ipa-install, ipaserver-master]
    Set admin's home directory to /export/home/admin	TAGS: [ipa-install, ipaserver-master]
    Enable password and OTP loging	TAGS: [ipa-install, ipaserver-master]
    Enable global DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
    Enable DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
    Enable reverse DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
    change resolv.conf to use FreeIPA DNS on all IPA systems	TAGS: [ipa-install, ipaserver-master]
    signal FreeIPA master has been deployed	TAGS: [ipa-install, ipaserver-master]
    signal FreeIPA client has been configured	TAGS: [ipa, ipa-install]
    Create Firefox prefs	TAGS: [ipa-install, ipaserver-master]
    Fetch Firefox prefs	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch krb5config	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch resolv.conf	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch cacert	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch ipa default.conf	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch kra agent pem file	TAGS: [fetch, ipa-install, ipaserver-master]

  play #5 (install FreeIPA server replica):	TAGS: []
    Create /export home directory with correct context	TAGS: [ipa-client, ipa-install]
    join FreeIPA	TAGS: [ipa-client, ipa-install]
    signal FreeIPA client has been configured	TAGS: [ipa, ipa-install]
    install replica	TAGS: [ipa-install, ipaserver-replica]
    Prepare replication	TAGS: [ipa-install, ipaserver-replica]
    Fetch replication file	TAGS: [fetch, ipa-install, ipaserver-replica]
    Copy replication file	TAGS: [ipa-install, ipaserver-replica]
    install replica	TAGS: [ipa-install, ipaserver-replica]
    flag replication installation	TAGS: [ipa-install, ipaserver-replica]
    signal FreeIPA client has been configured	TAGS: [ipa, ipa-install]

  play #6 (install FreeIPA client):	TAGS: []
    Create /export home directory with correct context	TAGS: [ipa-client, ipa-install]
    join FreeIPA	TAGS: [ipa-client, ipa-install]
    signal FreeIPA client has been configured	TAGS: [ipa, ipa-install]

  play #7 (install FreeIPA NFS server):	TAGS: []
    install nfs-utils	TAGS: [ipa-nfsserver, network, package-install]
    Open Firewall for NFS	TAGS: [firewall, ipa-nfsserver]
    Get keytab content	TAGS: [ipa-install, ipa-nfsserver]
    Create NFS service	TAGS: [ipa-install, ipa-nfsserver]
    Add NFS service to keytab	TAGS: [ipa-install, ipa-nfsserver]
    Create /exports/home	TAGS: [ipa-install, ipa-nfsserver]
    Add NFS export	TAGS: [ipa-install, ipa-nfsserver]
    Enable NFS server	TAGS: [ipa-install, ipa-nfsserver]
    add automount default location	TAGS: [ipa-install, ipa-nfsserver]
    add auto.home map	TAGS: [ipa-install, ipa-nfsserver]
    add auto.home to auto.master	TAGS: [ipa-install, ipa-nfsserver]
    automountkey-add default auto.home	TAGS: [ipa-install, ipa-nfsserver]
    Get FreeIPA users	TAGS: [ipa-install, ipa-nfs-homedirs, ipa-nfsserver]
    Create home directory for FreeIPA users	TAGS: [ipa-install, ipa-nfs-homedirs, ipa-nfsserver]
    Run ipa-client-automount on master, replicas and clients	TAGS: [ipa-install, ipa-nfsserver]

