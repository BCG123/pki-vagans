
playbook: ansible/playbook.yml

  play #1 (install Dogtag PKI CA):	TAGS: []
    Dummy (for ansible.skip_tags)	TAGS: [dummy]
    Check for dnf command	TAGS: [bootstrap, package-install]
    Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
    Refresh dnf cache	TAGS: [bootstrap, network, package-install]
    Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
    Gather facts	TAGS: [bootstrap]
    DNF or YUM?	TAGS: [common]
    Default facts (enable_packages, enable_network)	TAGS: [common]
    Override enable_packages=true	TAGS: [common, package-install]
    Override enable_network=true	TAGS: [common, network]
    fix /etc/hosts	TAGS: [common]
    Set FQDN hostname	TAGS: [common]
    Get timedatectl information	TAGS: [common]
    Set timezone to UTC	TAGS: [common]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto select fastest DNF mirror	TAGS: [common, package-install]
    Enable yum for Fedora	TAGS: [common, network, package-install]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto-select fastest yum mirror	TAGS: [common, network, package-install]
    Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
    Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
    Create directory for custom RPMS	TAGS: [common, custom-rpms]
    Synchronize RPMs	TAGS: [common, custom-rpms]
    find custom RPMs	TAGS: [common, custom-rpms]
    install custom RPMs	TAGS: [common, custom-rpms]
    install selinux tools	TAGS: [common, network, package-install]
    disable selinux for 389-DS installation	TAGS: [common, lxc]
    install firewalld	TAGS: [firewall, network, package-install, pki]
    check for firewalld	TAGS: [common, firewall]
    Enable and start firewalld	TAGS: [common, firewall]
    Install rng tools	TAGS: [common, network, package-install]
    Start the rngd service	TAGS: [common]
    tty-less sudo	TAGS: [common]
    install 389-DS LDAP server	TAGS: [389ds, network, package-install]
    create 389-DS instance	TAGS: [389ds]
    install pki-server packages and dependencies	TAGS: [network, package-install, pki]
    Open Firewall for services	TAGS: [firewall, pki]
    Open Firewall for ports	TAGS: [firewall, pki]
    install pki-ca package	TAGS: [network, package-install, pkica]
    Write CA config template	TAGS: [pkica]
    create CA	TAGS: [ipa-install, pkica]
    check for tomcat memory limit	TAGS: [pki, pki-install]
    limit tomcat memory	TAGS: [ipa-install, pki]
    restart tomcat	TAGS: [pki, pki-install]
    wait for tomcat	TAGS: [pki, pki-install]
    dump admin PKCS12 file to PEM file	TAGS: [pki, pki-install]
    fetch admin cert as /tmp/{{pki_instance_name}}_admin.pem	TAGS: [pki, pki-install]
    install pki-kra package	TAGS: [network, package-install, pkikra]
    Write KRA config template	TAGS: [pkikra]
    create KRA	TAGS: [ipa-install, pkikra]
    check for tomcat memory limit	TAGS: [pki, pki-install]
    limit tomcat memory	TAGS: [ipa-install, pki]
    restart tomcat	TAGS: [pki, pki-install]
    wait for tomcat	TAGS: [pki, pki-install]
    dump admin PKCS12 file to PEM file	TAGS: [pki, pki-install]
    fetch admin cert as /tmp/{{pki_instance_name}}_admin.pem	TAGS: [pki, pki-install]

  play #2 (install FreeIPA server master):	TAGS: []
    Dummy (for ansible.skip_tags)	TAGS: [dummy]
    Check for dnf command	TAGS: [bootstrap, package-install]
    Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
    Refresh dnf cache	TAGS: [bootstrap, network, package-install]
    Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
    Gather facts	TAGS: [bootstrap]
    DNF or YUM?	TAGS: [common]
    Default facts (enable_packages, enable_network)	TAGS: [common]
    Override enable_packages=true	TAGS: [common, package-install]
    Override enable_network=true	TAGS: [common, network]
    fix /etc/hosts	TAGS: [common]
    Set FQDN hostname	TAGS: [common]
    Get timedatectl information	TAGS: [common]
    Set timezone to UTC	TAGS: [common]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto select fastest DNF mirror	TAGS: [common, package-install]
    Enable yum for Fedora	TAGS: [common, network, package-install]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto-select fastest yum mirror	TAGS: [common, network, package-install]
    Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
    Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
    Create directory for custom RPMS	TAGS: [common, custom-rpms]
    Synchronize RPMs	TAGS: [common, custom-rpms]
    find custom RPMs	TAGS: [common, custom-rpms]
    install custom RPMs	TAGS: [common, custom-rpms]
    install selinux tools	TAGS: [common, network, package-install]
    disable selinux for 389-DS installation	TAGS: [common, lxc]
    install firewalld	TAGS: [firewall, network, package-install, pki]
    check for firewalld	TAGS: [common, firewall]
    Enable and start firewalld	TAGS: [common, firewall]
    Install rng tools	TAGS: [common, network, package-install]
    Start the rngd service	TAGS: [common]
    tty-less sudo	TAGS: [common]
    install FreeIPA client package (Fedora)	TAGS: [ipa, network, package-install]
    install FreeIPA client package (RHEL / CentOS)	TAGS: [ipa, network, package-install]
    get IPA version	TAGS: [ipa]
    Check for /etc/ipa/ca.crt	TAGS: [ipa]
    Check for /etc/ipa/default.conf	TAGS: [ipa]
    Set ipa_installed fact	TAGS: [ipa]
    install FreeIPA server package (Fedora)	TAGS: [ipaserver, network, package-install]
    install FreeIPA server package (RHEL / CentOS)	TAGS: [ipaserver, network, package-install]
    make a copy of original resolv.conf	TAGS: []
    Get default DNS	TAGS: [ipaserver]
    Get reverse zone	TAGS: [ipa-install, ipaserver]
    Open Firewall for services	TAGS: [firewall, ipaserver]
    Open Firewall for ports	TAGS: [firewall, ipaserver]
    Install FreeIPA master (5-7 minutes)	TAGS: [ipa-install, ipaserver-master]
    Install KRA on FreeIPA master (2-3 minutes)	TAGS: [ipa-install, ipaserver-master]
    Make sure named-pkcs11 DNS is running	TAGS: [ipa-install, ipaserver-master]
    wait for services to come up	TAGS: [ipa-install, ipaserver-master]
    Enable global DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
    Enable DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
    Enable reverse DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
    sync client clocks	TAGS: [ipa-install, ipaserver-master]
    change replicas' resolv.conf to use FreeIPA DNS	TAGS: [ipa-install, ipaserver-master]
    change clients' resolv.conf to use FreeIPA DNS	TAGS: [ipa-install, ipaserver-master]
    change master's resolv.conf to use FreeIPA DNS	TAGS: [ipa-install, ipaserver-master]
    signal FreeIPA master has been deployed	TAGS: [ipa-install, ipaserver-master]
    Create Firefox prefs	TAGS: [ipa-install, ipaserver-master]
    Fetch Firefox prefs	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch krb5config	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch resolv.conf	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch cacert	TAGS: [fetch, ipa-install, ipaserver-master]
    Fetch kra agent pem file	TAGS: [fetch, ipa-install, ipaserver-master]

  play #3 (install FreeIPA server replica):	TAGS: []
    Dummy (for ansible.skip_tags)	TAGS: [dummy]
    Check for dnf command	TAGS: [bootstrap, package-install]
    Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
    Refresh dnf cache	TAGS: [bootstrap, network, package-install]
    Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
    Gather facts	TAGS: [bootstrap]
    DNF or YUM?	TAGS: [common]
    Default facts (enable_packages, enable_network)	TAGS: [common]
    Override enable_packages=true	TAGS: [common, package-install]
    Override enable_network=true	TAGS: [common, network]
    fix /etc/hosts	TAGS: [common]
    Set FQDN hostname	TAGS: [common]
    Get timedatectl information	TAGS: [common]
    Set timezone to UTC	TAGS: [common]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto select fastest DNF mirror	TAGS: [common, package-install]
    Enable yum for Fedora	TAGS: [common, network, package-install]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto-select fastest yum mirror	TAGS: [common, network, package-install]
    Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
    Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
    Create directory for custom RPMS	TAGS: [common, custom-rpms]
    Synchronize RPMs	TAGS: [common, custom-rpms]
    find custom RPMs	TAGS: [common, custom-rpms]
    install custom RPMs	TAGS: [common, custom-rpms]
    install selinux tools	TAGS: [common, network, package-install]
    disable selinux for 389-DS installation	TAGS: [common, lxc]
    install firewalld	TAGS: [firewall, network, package-install, pki]
    check for firewalld	TAGS: [common, firewall]
    Enable and start firewalld	TAGS: [common, firewall]
    Install rng tools	TAGS: [common, network, package-install]
    Start the rngd service	TAGS: [common]
    tty-less sudo	TAGS: [common]
    install FreeIPA client package (Fedora)	TAGS: [ipa, network, package-install]
    install FreeIPA client package (RHEL / CentOS)	TAGS: [ipa, network, package-install]
    get IPA version	TAGS: [ipa]
    Check for /etc/ipa/ca.crt	TAGS: [ipa]
    Check for /etc/ipa/default.conf	TAGS: [ipa]
    Set ipa_installed fact	TAGS: [ipa]
    install FreeIPA server package (Fedora)	TAGS: [ipaserver, network, package-install]
    install FreeIPA server package (RHEL / CentOS)	TAGS: [ipaserver, network, package-install]
    make a copy of original resolv.conf	TAGS: []
    Get default DNS	TAGS: [ipaserver]
    Get reverse zone	TAGS: [ipa-install, ipaserver]
    Open Firewall for services	TAGS: [firewall, ipaserver]
    Open Firewall for ports	TAGS: [firewall, ipaserver]
    wait for master deployment (may take 5 minutes or more)	TAGS: [ipa-install]
    wait for master DNS configuration	TAGS: [ipa-install]
    Extra sleep again to prevent race condition (#5653)	TAGS: [ipa-install, ipaserver-replica, sleep]
    Magic wait to make ipa-client-install work	TAGS: [ipa-client, ipa-install, sleep]
    join FreeIPA	TAGS: [ipa-client, ipa-install]
    install replica	TAGS: [ipa-install, ipaserver-replica]
    wait for master deployment (may take 5 minutes or more)	TAGS: [ipa-install]
    wait for master DNS configuration	TAGS: [ipa-install]
    Prepare replication	TAGS: [ipa-install, ipaserver-replica]
    Fetch replication file	TAGS: [fetch, ipa-install, ipaserver-replica]
    Copy replication file	TAGS: [ipa-install, ipaserver-replica]
    install replica	TAGS: [ipa-install, ipaserver-replica]
    flag replication installation	TAGS: [ipa-install, ipaserver-replica]

  play #4 (install FreeIPA client):	TAGS: []
    Dummy (for ansible.skip_tags)	TAGS: [dummy]
    Check for dnf command	TAGS: [bootstrap, package-install]
    Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
    Refresh dnf cache	TAGS: [bootstrap, network, package-install]
    Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
    Gather facts	TAGS: [bootstrap]
    DNF or YUM?	TAGS: [common]
    Default facts (enable_packages, enable_network)	TAGS: [common]
    Override enable_packages=true	TAGS: [common, package-install]
    Override enable_network=true	TAGS: [common, network]
    fix /etc/hosts	TAGS: [common]
    Set FQDN hostname	TAGS: [common]
    Get timedatectl information	TAGS: [common]
    Set timezone to UTC	TAGS: [common]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto select fastest DNF mirror	TAGS: [common, package-install]
    Enable yum for Fedora	TAGS: [common, network, package-install]
    Disable repos to prevent network access	TAGS: [common]
    Enable repos	TAGS: [common]
    Auto-select fastest yum mirror	TAGS: [common, network, package-install]
    Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
    Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
    upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
    Create directory for custom RPMS	TAGS: [common, custom-rpms]
    Synchronize RPMs	TAGS: [common, custom-rpms]
    find custom RPMs	TAGS: [common, custom-rpms]
    install custom RPMs	TAGS: [common, custom-rpms]
    install selinux tools	TAGS: [common, network, package-install]
    disable selinux for 389-DS installation	TAGS: [common, lxc]
    install firewalld	TAGS: [firewall, network, package-install, pki]
    check for firewalld	TAGS: [common, firewall]
    Enable and start firewalld	TAGS: [common, firewall]
    Install rng tools	TAGS: [common, network, package-install]
    Start the rngd service	TAGS: [common]
    tty-less sudo	TAGS: [common]
    install FreeIPA client package (Fedora)	TAGS: [ipa, network, package-install]
    install FreeIPA client package (RHEL / CentOS)	TAGS: [ipa, network, package-install]
    get IPA version	TAGS: [ipa]
    Check for /etc/ipa/ca.crt	TAGS: [ipa]
    Check for /etc/ipa/default.conf	TAGS: [ipa]
    Set ipa_installed fact	TAGS: [ipa]
    wait for master deployment (may take 5 minutes or more)	TAGS: [ipa-install]
    wait for master DNS configuration	TAGS: [ipa-install]
    Magic wait to make ipa-client-install work	TAGS: [ipa-client, ipa-install, sleep]
    join FreeIPA	TAGS: [ipa-client, ipa-install]

