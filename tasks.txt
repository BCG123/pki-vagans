
playbook: ansible/playbook.yml

  play #1 (all): safe-guard against race condition	TAGS: []
    tasks:
      wait for the node to be ready	TAGS: []

  play #2 (pki_server): install Dogtag PKI CA	TAGS: []
    tasks:
      bootstrap : Check default route	TAGS: [bootstrap]
      bootstrap : Create some default route	TAGS: [bootstrap]
      bootstrap : Check nameserver in /etc/resolv.conf	TAGS: [bootstrap]
      bootstrap : Kick DHCP in case /etc/resolv.conf is missing nameserver	TAGS: [bootstrap]
      bootstrap : Check for dnf command	TAGS: [bootstrap, package-install]
      bootstrap : Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
      bootstrap : Refresh dnf cache	TAGS: [bootstrap, network, package-install]
      bootstrap : Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
      bootstrap : Gather facts	TAGS: [bootstrap]
      bootstrap : Dump ssh-config	TAGS: [bootstrap]
      bootstrap : Dummy (for ansible.skip_tags)	TAGS: [dummy]
      include	TAGS: []
      common : fix /etc/hosts	TAGS: [common]
      common : Set FQDN hostname	TAGS: [common]
      common : Get timedatectl information	TAGS: [common]
      common : Set timezone to UTC	TAGS: [common]
      include	TAGS: []
      include	TAGS: []
      common : Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
      common : Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
      common : Create directory for custom RPMS	TAGS: [common, custom-rpms]
      common : Synchronize RPMs	TAGS: [common, custom-rpms]
      common : find custom RPMs	TAGS: [common, custom-rpms]
      common : install custom RPMs	TAGS: [common, custom-rpms]
      common : install selinux tools	TAGS: [common, network, package-install]
      common : disable selinux for 389-DS installation	TAGS: [common, lxc]
      common : install firewalld	TAGS: [firewall, network, package-install, pki]
      common : check for firewalld	TAGS: [common, firewall]
      common : Enable and start firewalld	TAGS: [common, firewall]
      common : Install rng tools	TAGS: [common, network, package-install]
      common : Start the rngd service	TAGS: [common]
      common : tty-less sudo	TAGS: [common]
      bootstrap : Check default route	TAGS: [bootstrap]
      bootstrap : Create some default route	TAGS: [bootstrap]
      bootstrap : Check nameserver in /etc/resolv.conf	TAGS: [bootstrap]
      bootstrap : Kick DHCP in case /etc/resolv.conf is missing nameserver	TAGS: [bootstrap]
      bootstrap : Check for dnf command	TAGS: [bootstrap, package-install]
      bootstrap : Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
      bootstrap : Refresh dnf cache	TAGS: [bootstrap, network, package-install]
      bootstrap : Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
      bootstrap : Gather facts	TAGS: [bootstrap]
      bootstrap : Dump ssh-config	TAGS: [bootstrap]
      bootstrap : Dummy (for ansible.skip_tags)	TAGS: [dummy]
      include	TAGS: []
      common : fix /etc/hosts	TAGS: [common]
      common : Set FQDN hostname	TAGS: [common]
      common : Get timedatectl information	TAGS: [common]
      common : Set timezone to UTC	TAGS: [common]
      include	TAGS: []
      include	TAGS: []
      common : Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
      common : Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
      common : Create directory for custom RPMS	TAGS: [common, custom-rpms]
      common : Synchronize RPMs	TAGS: [common, custom-rpms]
      common : find custom RPMs	TAGS: [common, custom-rpms]
      common : install custom RPMs	TAGS: [common, custom-rpms]
      common : install selinux tools	TAGS: [common, network, package-install]
      common : disable selinux for 389-DS installation	TAGS: [common, lxc]
      common : install firewalld	TAGS: [firewall, network, package-install, pki]
      common : check for firewalld	TAGS: [common, firewall]
      common : Enable and start firewalld	TAGS: [common, firewall]
      common : Install rng tools	TAGS: [common, network, package-install]
      common : Start the rngd service	TAGS: [common]
      common : tty-less sudo	TAGS: [common]
      pki-389ds : install 389-DS LDAP server	TAGS: [389ds, network, package-install]
      pki-389ds : create 389-DS instance	TAGS: [389ds]
      pki : install pki-server packages and dependencies	TAGS: [network, package-install, pki]
      pki : Open Firewall for services	TAGS: [firewall, pki]
      pki : Open Firewall for ports	TAGS: [firewall, pki]
      pki-ca : install pki-ca package	TAGS: [network, package-install, pkica]
      pki-ca : Write CA config template	TAGS: [pkica]
      pki-ca : create CA	TAGS: [ipa-install, pkica]
      include	TAGS: []
      include	TAGS: []
      bootstrap : Check default route	TAGS: [bootstrap]
      bootstrap : Create some default route	TAGS: [bootstrap]
      bootstrap : Check nameserver in /etc/resolv.conf	TAGS: [bootstrap]
      bootstrap : Kick DHCP in case /etc/resolv.conf is missing nameserver	TAGS: [bootstrap]
      bootstrap : Check for dnf command	TAGS: [bootstrap, package-install]
      bootstrap : Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
      bootstrap : Refresh dnf cache	TAGS: [bootstrap, network, package-install]
      bootstrap : Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
      bootstrap : Gather facts	TAGS: [bootstrap]
      bootstrap : Dump ssh-config	TAGS: [bootstrap]
      bootstrap : Dummy (for ansible.skip_tags)	TAGS: [dummy]
      include	TAGS: []
      common : fix /etc/hosts	TAGS: [common]
      common : Set FQDN hostname	TAGS: [common]
      common : Get timedatectl information	TAGS: [common]
      common : Set timezone to UTC	TAGS: [common]
      include	TAGS: []
      include	TAGS: []
      common : Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
      common : Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
      common : Create directory for custom RPMS	TAGS: [common, custom-rpms]
      common : Synchronize RPMs	TAGS: [common, custom-rpms]
      common : find custom RPMs	TAGS: [common, custom-rpms]
      common : install custom RPMs	TAGS: [common, custom-rpms]
      common : install selinux tools	TAGS: [common, network, package-install]
      common : disable selinux for 389-DS installation	TAGS: [common, lxc]
      common : install firewalld	TAGS: [firewall, network, package-install, pki]
      common : check for firewalld	TAGS: [common, firewall]
      common : Enable and start firewalld	TAGS: [common, firewall]
      common : Install rng tools	TAGS: [common, network, package-install]
      common : Start the rngd service	TAGS: [common]
      common : tty-less sudo	TAGS: [common]
      bootstrap : Check default route	TAGS: [bootstrap]
      bootstrap : Create some default route	TAGS: [bootstrap]
      bootstrap : Check nameserver in /etc/resolv.conf	TAGS: [bootstrap]
      bootstrap : Kick DHCP in case /etc/resolv.conf is missing nameserver	TAGS: [bootstrap]
      bootstrap : Check for dnf command	TAGS: [bootstrap, package-install]
      bootstrap : Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
      bootstrap : Refresh dnf cache	TAGS: [bootstrap, network, package-install]
      bootstrap : Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
      bootstrap : Gather facts	TAGS: [bootstrap]
      bootstrap : Dump ssh-config	TAGS: [bootstrap]
      bootstrap : Dummy (for ansible.skip_tags)	TAGS: [dummy]
      include	TAGS: []
      common : fix /etc/hosts	TAGS: [common]
      common : Set FQDN hostname	TAGS: [common]
      common : Get timedatectl information	TAGS: [common]
      common : Set timezone to UTC	TAGS: [common]
      include	TAGS: []
      include	TAGS: []
      common : Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
      common : Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
      common : Create directory for custom RPMS	TAGS: [common, custom-rpms]
      common : Synchronize RPMs	TAGS: [common, custom-rpms]
      common : find custom RPMs	TAGS: [common, custom-rpms]
      common : install custom RPMs	TAGS: [common, custom-rpms]
      common : install selinux tools	TAGS: [common, network, package-install]
      common : disable selinux for 389-DS installation	TAGS: [common, lxc]
      common : install firewalld	TAGS: [firewall, network, package-install, pki]
      common : check for firewalld	TAGS: [common, firewall]
      common : Enable and start firewalld	TAGS: [common, firewall]
      common : Install rng tools	TAGS: [common, network, package-install]
      common : Start the rngd service	TAGS: [common]
      common : tty-less sudo	TAGS: [common]
      pki-389ds : install 389-DS LDAP server	TAGS: [389ds, network, package-install]
      pki-389ds : create 389-DS instance	TAGS: [389ds]
      pki : install pki-server packages and dependencies	TAGS: [network, package-install, pki]
      pki : Open Firewall for services	TAGS: [firewall, pki]
      pki : Open Firewall for ports	TAGS: [firewall, pki]
      pki-kra : install pki-kra package	TAGS: [network, package-install, pkikra]
      pki-kra : Write KRA config template	TAGS: [pkikra]
      pki-kra : create KRA	TAGS: [ipa-install, pkikra]
      include	TAGS: []
      include	TAGS: []

  play #3 (ipaserver_master,ipaserver_replica,ipa_client,ipa_nfsserver): install IPA base system	TAGS: []
    tasks:
      bootstrap : Check default route	TAGS: [bootstrap]
      bootstrap : Create some default route	TAGS: [bootstrap]
      bootstrap : Check nameserver in /etc/resolv.conf	TAGS: [bootstrap]
      bootstrap : Kick DHCP in case /etc/resolv.conf is missing nameserver	TAGS: [bootstrap]
      bootstrap : Check for dnf command	TAGS: [bootstrap, package-install]
      bootstrap : Auto select fastest DNF mirror	TAGS: [bootstrap, package-install]
      bootstrap : Refresh dnf cache	TAGS: [bootstrap, network, package-install]
      bootstrap : Install python2 and deps for ansible modules	TAGS: [bootstrap, network, package-install]
      bootstrap : Gather facts	TAGS: [bootstrap]
      bootstrap : Dump ssh-config	TAGS: [bootstrap]
      bootstrap : Dummy (for ansible.skip_tags)	TAGS: [dummy]
      include	TAGS: []
      common : fix /etc/hosts	TAGS: [common]
      common : Set FQDN hostname	TAGS: [common]
      common : Get timedatectl information	TAGS: [common]
      common : Set timezone to UTC	TAGS: [common]
      include	TAGS: []
      include	TAGS: []
      common : Install gpg command for COPR / rpm_key	TAGS: [common, network, package-copr, package-install]
      common : Add GPG for FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : Enable FreeIPA 4.3 COPR	TAGS: [common, network, package-copr, package-install]
      common : upgrade all packages	TAGS: [common, network, package-install, package-upgrade]
      common : Create directory for custom RPMS	TAGS: [common, custom-rpms]
      common : Synchronize RPMs	TAGS: [common, custom-rpms]
      common : find custom RPMs	TAGS: [common, custom-rpms]
      common : install custom RPMs	TAGS: [common, custom-rpms]
      common : install selinux tools	TAGS: [common, network, package-install]
      common : disable selinux for 389-DS installation	TAGS: [common, lxc]
      common : install firewalld	TAGS: [firewall, network, package-install, pki]
      common : check for firewalld	TAGS: [common, firewall]
      common : Enable and start firewalld	TAGS: [common, firewall]
      common : Install rng tools	TAGS: [common, network, package-install]
      common : Start the rngd service	TAGS: [common]
      common : tty-less sudo	TAGS: [common]
      ipa : gather facts from FreeIPA master server	TAGS: []
      ipa : make a copy of original resolv.conf	TAGS: [ipa]
      ipa : Get default DNS	TAGS: [ipa]
      ipa : Get reverse zone	TAGS: [ipa]
      ipa : change resolv.conf to use FreeIPA DNS	TAGS: [ipa, ipa-install]
      ipa : install FreeIPA client package (Fedora)	TAGS: [ipa, network, package-install]
      ipa : install FreeIPA client package (RHEL / CentOS)	TAGS: [ipa, network, package-install]
      ipa : get IPA version	TAGS: [ipa]
      ipa : Check for /etc/ipa/ca.crt	TAGS: [ipa]
      ipa : Check for /etc/ipa/default.conf	TAGS: [ipa]
      ipa : Set ipa_installed fact	TAGS: [ipa]

  play #4 (ipaserver_master,ipaserver_replica): install IPA server system	TAGS: []
    tasks:
      ipaserver : install FreeIPA server package (Fedora)	TAGS: [ipaserver, network, package-install]
      ipaserver : install FreeIPA server package (RHEL / CentOS)	TAGS: [ipaserver, network, package-install]
      ipaserver : Open Firewall for services	TAGS: [firewall, ipaserver]
      ipaserver : Open Firewall for ports	TAGS: [firewall, ipaserver]

  play #5 (ipaserver_master): install FreeIPA server master	TAGS: []
    tasks:
      ipaserver-master : Install FreeIPA master (5-7 minutes)	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Install KRA on FreeIPA master (2-3 minutes)	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Make sure named-pkcs11 DNS is running	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : wait for services to come up	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Set sensible defaults	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Set home directory to /export/home	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Set admin's home directory to /export/home/admin	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Enable password and OTP loging	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Enable global DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Enable DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Enable reverse DNS sync ptr	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : signal FreeIPA master has been deployed	TAGS: [ipa-install, ipaserver-master]
      include	TAGS: []
      ipaserver-master : Create Firefox prefs	TAGS: [ipa-install, ipaserver-master]
      ipaserver-master : Fetch Firefox prefs	TAGS: [fetch, ipa-install, ipaserver-master]
      ipaserver-master : Fetch krb5config	TAGS: [fetch, ipa-install, ipaserver-master]
      ipaserver-master : Fetch resolv.conf	TAGS: [fetch, ipa-install, ipaserver-master]
      ipaserver-master : Fetch cacert	TAGS: [fetch, ipa-install, ipaserver-master]
      ipaserver-master : Fetch ipa default.conf	TAGS: [fetch, ipa-install, ipaserver-master]
      ipaserver-master : Fetch kra agent pem file	TAGS: [fetch, ipa-install, ipaserver-master]
      ipaserver-master : Get FreeIPA users	TAGS: [ipa-install, ipaserver-master]

  play #6 (ipaserver_replica): install FreeIPA server replica	TAGS: []
    tasks:
      include	TAGS: []
      include	TAGS: []
      include	TAGS: []
      ipaserver-replica : flag replication installation	TAGS: [ipa-install, ipaserver-replica]
      include	TAGS: []

  play #7 (ipa_client): install FreeIPA client	TAGS: []
    tasks:
      include	TAGS: []
      include	TAGS: []

  play #8 (ipa_nfsserver): install FreeIPA NFS server	TAGS: []
    tasks:
      include	TAGS: []
      include	TAGS: []
      ipa-nfsserver : install nfs-utils	TAGS: [ipa-nfsserver, network, package-install]
      ipa-nfsserver : Open Firewall for NFS	TAGS: [firewall, ipa-nfsserver]
      ipa-nfsserver : Get keytab content	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : Create NFS service	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : Add NFS service to keytab	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : Create /exports/home	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : Add NFS export	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : Enable NFS server	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : add automount default location	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : add auto.home map	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : add auto.home to auto.master	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : automountkey-add default auto.home	TAGS: [ipa-install, ipa-nfsserver]
      ipa-nfsserver : Get FreeIPA users	TAGS: [ipa-install, ipa-nfs-homedirs, ipa-nfsserver]
      ipa-nfsserver : Create home directory for FreeIPA users	TAGS: [ipa-install, ipa-nfs-homedirs, ipa-nfsserver]
      include	TAGS: []
      ipa-nfsserver : Run ipa-client-automount on master, replicas and clients	TAGS: [ipa-install, ipa-nfsserver]
